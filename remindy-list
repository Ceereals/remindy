#!/bin/bash
set -eEo pipefail

source "$(dirname "${BASH_SOURCE[0]}")/remindy-common"

if [[ "${1:-}" == "-h" || "${1:-}" == "--help" ]]; then
  echo "Usage: $(basename "$0")"
  echo "Browse reminders interactively."
  exit 0
fi

clear

data=$(lock_read)
count=$(echo "$data" | jq '.reminders | length')

if [[ "$count" -eq 0 ]]; then
  msg_warn "No reminders"
  echo ""
  read -n 1 -s -r -p "Press any key to continue..."
  exit 0
fi

format_reminders "$data" "$ICON_YES" "$ICON_NO" | \
  gum filter --header "$(banner_header)" --no-limit --placeholder "Browse reminders (ESC to close)..." > /dev/null
